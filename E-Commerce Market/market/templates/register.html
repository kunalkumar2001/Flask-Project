<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Register | Flask Market</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>

body{
height:100vh;
margin:0;
background:#05060f;
overflow:hidden;
font-family:'Poppins',sans-serif;
}

body::before{
content:'';
position:fixed;
inset:-30%;
background:
radial-gradient(circle at 20% 20%,#4facfe,transparent 40%),
radial-gradient(circle at 80% 30%,#00f2fe,transparent 40%),
radial-gradient(circle at 50% 80%,#8e2de2,transparent 40%);
filter:blur(90px);
animation:bgMove 14s infinite alternate;
}

@keyframes bgMove{
from{transform:scale(1);}
to{transform:scale(1.3) rotate(90deg);}
}

.container{
position:relative;
z-index:2;
max-width:420px;
}

.form-register{
padding:40px;
border-radius:20px;
background:rgba(255,255,255,0.12);
backdrop-filter:blur(18px);
box-shadow:0 25px 60px rgba(0,0,0,0.45);
}

.logo{
width:70px;
}

label{
float:left;
margin-top:10px;
color:white;
}

.form-control{
border-radius:10px;
border:none;
background:rgba(255,255,255,0.18);
color:white;
}

.btn-primary{
border-radius:30px;
background:linear-gradient(90deg,#00f2fe,#4facfe);
border:none;
}

.error{
color:#ff6b6b;
font-size:13px;
text-align:left;
}

.password-wrapper{
position:relative;
}

.toggle-password{
position:absolute;
right:10px;
top:50%;
transform:translateY(-50%);
cursor:pointer;
color:white;
}

.strength{
height:6px;
background:#333;
margin-top:5px;
border-radius:10px;
}

.strength-bar{
height:100%;
width:0%;
border-radius:10px;
}

.strength-text{
color:white;
font-size:12px;
text-align:left;
}

#successAnimation{
position:fixed;
inset:0;
background:#05060f;
display:none;
justify-content:center;
align-items:center;
flex-direction:column;
z-index:999;
}

.success-circle{
width:120px;
height:120px;
border-radius:50%;
background:#2ecc71;
display:flex;
justify-content:center;
align-items:center;
font-size:60px;
color:white;
}

.success-text{
color:white;
margin-top:20px;
font-size:22px;
}

</style>

</head>

<body class="text-center">

<div class="container">

<form method="POST" class="form-register">

<img src="{{ url_for('static', filename='images/logo.png') }}" class="logo mb-3">

<h4 class="text-white">Create Account</h4>

{{ form.hidden_tag() }}

<!-- USERNAME -->

{{ form.username.label() }}
{{ form.username(class="form-control", placeholder="Username") }}

{% for error in form.username.errors %}
<div class="error">{{ error }}</div>
{% endfor %}

<!-- EMAIL -->

{{ form.email_address.label() }}
{{ form.email_address(class="form-control", id="email", placeholder="Email") }}

<small id="emailAlert" class="error" style="display:none;">
Invalid email address
</small>

{% for error in form.email_address.errors %}
<div class="error">{{ error }}</div>
{% endfor %}

<!-- PASSWORD -->

{{ form.password1.label() }}

<div class="password-wrapper">

{{ form.password1(class="form-control", id="password", placeholder="Password") }}

<span class="toggle-password" onclick="togglePassword()">üëÅ</span>

</div>

<div class="strength">
<div class="strength-bar" id="strengthBar"></div>
</div>

<div class="strength-text" id="strengthText"></div>

{% for error in form.password1.errors %}
<div class="error">{{ error }}</div>
{% endfor %}

<!-- CONFIRM PASSWORD -->

{{ form.password2.label() }}

{{ form.password2(class="form-control", placeholder="Confirm Password") }}

{% for error in form.password2.errors %}
<div class="error">{{ error }}</div>
{% endfor %}

<br>

{{ form.submit(class="btn btn-primary btn-block", id="submitBtn") }}

</form>

</div>

<!-- SUCCESS ANIMATION -->

<div id="successAnimation">

<div class="success-circle">‚úì</div>

<div class="success-text">Account Created Successfully!</div>

</div>

<script>

/* EMAIL VALIDATION */

const email=document.getElementById("email");
const submitBtn=document.getElementById("submitBtn");

email.addEventListener("input",()=>{

const regex=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;

if(regex.test(email.value)){

email.style.border="2px solid #2ecc71";
document.getElementById("emailAlert").style.display="none";

}else{

email.style.border="2px solid red";
document.getElementById("emailAlert").style.display="block";

}

});

/* PASSWORD TOGGLE */

function togglePassword(){

const password=document.getElementById("password");

password.type=password.type==="password"?"text":"password";

}

/* PASSWORD STRENGTH */

const password=document.getElementById("password");

password.addEventListener("input",()=>{

let strength=0;
const val=password.value;

if(val.length>=6) strength++;
if(/[A-Z]/.test(val)) strength++;
if(/[0-9]/.test(val)) strength++;
if(/[^A-Za-z0-9]/.test(val)) strength++;

const bar=document.getElementById("strengthBar");
const text=document.getElementById("strengthText");

bar.style.width=(strength*25)+"%";

if(strength<=1){

bar.style.background="red";
text.innerHTML="Weak";

}
else if(strength==2){

bar.style.background="orange";
text.innerHTML="Medium";

}
else if(strength==3){

bar.style.background="yellow";
text.innerHTML="Good";

}
else{

bar.style.background="#2ecc71";
text.innerHTML="Strong";

}

});

/* SUCCESS */

function showSuccess(){

document.querySelector(".form-register").style.display="none";

document.getElementById("successAnimation").style.display="flex";

setTimeout(()=>{

window.location.href="/login";

},2000);

}

</script>

{% if success %}

<script>

showSuccess();

</script>

{% endif %}

</body>
</html>